# 収益化宣言プラグイン

こちらは開発者向けの説明書です。  
使用者向けは「収益化宣言プラグイン」フォルダ内の**readme.txt**をご覧ください。  
また、現段階はα版です。

## 収益化宣言プラグインについて

このプラグインは、以下の環境専用のプラグインです。

- [tyranoscript](https://tyrano.jp/)製のゲーム
- V500以降
- PC版のみ(ブラウザ、スマホ版✖)

>今後…[tyranobuilder](https://b.tyrano.jp/)に対応

### 予想される利用者

- 上記環境のゲーム開発者
- 有料版を販売するに至らない動機を持ち、無料配布をしている開発者
- 自身のフリーゲームを利用して(将来的を含む)利益が発生するのに自身に利益がない開発者

### 解決する課題

このプラグインを使うことで、以下の課題が解決されます。

- ゲームはバズったのに自身に1円も利益がない状況を改善します。
- 利益が発生しない一般ユーザーに負担をかけずに課題解決の方向に導きます。

## 機能

- ゲーム画面外で動作を検知したとき、ゲームを自動で止めて『お伺いの画面』を出します。
- [confirm]タグを使うことで、任意の箇所で『お伺いの画面』を出します。
- ゲームとは**別途にpatchファイルを入れることで**、このプラグインの機能を全て停止させます。
- patchファイルは各ECサイトで自由な価格で販売が可能です。

>今後…虚偽(例：有償なのに無償として配信ボタンを選択など)の対応策

``` mermaid
---
title: 完成予想図
---
stateDiagram-v2
    state "注意書き" as 0
    state "配信していない" as 10
    state "配信している" as 11
    state "収益が発生する" as 111
    state "無配信モード" as A
    state "無料配信モード" as B
    state "有料配信モード" as C

    [*]-->first.ks
    0-->10
    0-->11
    11-->111
    state first.ks{
        0   10  11  111
    }
    10-->A
    11-->B
    111-->C:パッチ販売サイトで購入
    state GAMEstart{
        A B C
    }
```

---

``` mermaid
---
title: 各モードの動作予定図
---
sequenceDiagram

        box gray 外部サイト
        participant D as パッチ販売サイト
    end
    box ゲーム内
        participant A as 無配信モード
        participant B as 無料配信モード
        participant C as 有料配信モード
    end
    note over C:有料を買ったかどうかの<br>表記を行うか選べる

    critical 任意のポイントを経過
        note over A,B :収益化プラグイン動作中のことを明記
        C->>C:パッチを購入したことを表記or<br>このポイントを無視する
        option モード切替示唆

        note over A,B : 全画面画像とボタンを表示。ゲームを続けるには5秒ほど待つ。

            A ->>B:「もし配信しているならこちら」
            A -xD:「有料配信ならこちらを行いなさい」<br>(強制ゲームEND)
            A ->>A:「私は配信していません」ボタン
            B -xD:「有料配信ならこちらを行いなさい」(強制ゲームEND)
            B ->>B:「私の配信には収益は発生しません」ボタン
        note over A,B:画面外で動作を検知したときも同じ動作
    end

    
```

- **sf.monetization_mode**という変数が  
0の時、「無配信モード」  
1の時「無料配信モード」  
2の時「有料配信モード」に変化します。
- 2に変化するのはpatchをあてたときのみです。

---

## 今後の追加機能予定

- UIの改善
- [tyranobuilder](https://b.tyrano.jp/)対応
- プラグイン使用者がレベルを設定

|  レベル  |  条件(配信は前提)  |　虚偽の懲罰 |
| ---- | ---- | ---- |
レベル1 | 配信プラットフォームの収益発生条件を満たしていない | 通常 |
レベル2 | このゲームの配信で収益を発生させる(スパチャなど) | 強制終了(自動セーブ) |
レベル3 | 配信プラットフォームの収益発生条件を満たしている |　強制終了(sf,f削除・初期化) |

- pauseさせる時間を任意で設定
- 表示させる画像を任意に決定(またはランダム化)
- パッチ販売URLなど、値をCUI的に打ち込んで変更できる機能

## わかっている問題点

- [confirm]の後、コードが1行先に進む
    - [sleepgame]中に[dialog]を発生させているため。β版で削除予定。

## 適用方法

詳細は使用者向けreadme.txtをご覧ください。

サンプルゲームとパッチは[こちら](https://booth.pm/ja/items/4709269)


## クレジット

作成者：ききよ(@\_kikiyo\_)

## ライセンス

[MITライセンス](https://licenses.opensource.jp/MIT/MIT.html)に準拠します。 　
©:ききよ/kikiyoushin

## 終わりに

お気軽にissueまでどうぞ。
